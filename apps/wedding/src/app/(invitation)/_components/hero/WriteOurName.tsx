"use client";

import { motion, useInView } from "motion/react";
import { useRef } from "react";

type NameType = "groom" | "bride";

interface WriteOurNameProps {
  name: NameType;
  className?: string;
}

// 이형민 획순별 SVG paths (글자별로 분리)
const GROOM_STROKES = [
  // 이 (ㅇ)
  "M18.3019 8.59418C14.2507 7.85233 11.2743 8.49107 10.1375 9.52149C8.92151 10.6236 7.57764 12.4047 7.03718 13.9519C6.46414 15.5925 5.95108 16.543 6.00373 18.2794C6.05047 19.8209 6.45252 20.6638 7.03718 22.0916C7.57651 23.4087 7.80032 24.2648 8.79406 25.2857C10.3863 26.9214 11.9852 27.3231 14.2714 27.3464C16.8419 27.3725 18.5006 26.634 20.3688 24.8736C21.8277 23.4988 22.377 22.3605 22.9524 20.4431C23.6581 18.0916 23.7878 16.4669 22.9524 14.158C22.4545 12.7818 22.246 11.9783 21.2988 10.8609C20.3945 9.79412 19.6798 8.84651 18.3019 8.59418Z",
  // 이 (ㅣ)
  "M34.4238 2L35.0439 33.3223",
  // 형 (ㅎ) - 점
  "M56.5398 2.82427V8.59418",
  // 형 (ㅎ) - 가로획
  "M56.5398 8.59418L49.0989 9.10928M56.5398 8.59418H63.5673",
  // 형 (ㅎ) - ㅇ
  "M57.8833 14.158C58.7568 13.9993 59.3093 13.8944 60.1569 14.158C61.5746 14.599 62.0519 15.6281 62.7405 16.9399C63.3942 18.1851 63.7579 19.0506 63.5673 20.4431C63.3892 21.7448 62.9556 22.5089 62.0171 23.4311C60.9751 24.4549 60.0546 24.7674 58.6067 24.9766C57.0701 25.1986 55.9471 25.2523 54.6796 24.3584C53.5268 23.5454 53.0184 22.661 52.8193 21.2674C52.6993 20.427 52.4962 20.0267 52.716 19.2067C52.9583 18.3025 53.0776 17.7529 53.5428 16.9399C53.8756 16.3582 54.5234 15.9796 54.9896 15.4975C55.8543 14.6032 56.6576 14.3808 57.8833 14.158Z",
  // 형 (ㅕ) - 가로획 상단
  "M68.8379 14.8793L74.6253 14.158",
  // 형 (ㅕ) - 가로획 하단
  "M69.3547 19.1037L74.6253 17.8672",
  // 형 (ㅕ) - 세로획
  "M74.6253 7.25474V23.4311",
  // 형 (ㅇ)
  "M68.3212 27.3464C66.7392 27.8498 65.8144 27.9699 64.7041 29.201C63.6869 30.3289 63.3436 31.822 63.5673 33.3223C63.7322 34.4282 63.9632 35.059 64.7041 35.8982C65.7247 37.0543 66.787 37.7789 68.3212 37.9589C69.8554 38.1388 71.1275 37.716 72.455 36.9285C73.5875 36.2568 74.0743 35.6491 74.6253 34.4557C75.1653 33.2861 74.9649 32.4009 74.6253 31.1586C74.35 30.1515 74.0967 29.5546 73.3851 28.7889C72.6466 27.9941 72.0882 27.4667 71.0082 27.3464C70.1423 27.2499 69.1512 27.0822 68.3212 27.3464Z",
  // 민 (ㅁ)
  "M93.5376 7.97597L102.839 8.59418L103.355 18.4854H93.5376V7.97597Z",
  // 민 (ㅣ)
  "M109.763 7.4608L110.383 21.1643",
  // 민 (ㄴ)
  "M100.668 27.3464L101.599 34.1466H114",
];

// 임희재 획순별 SVG paths (글자별로 분리)
const BRIDE_STROKES = [
  // 임 (ㅇ)
  "M13.421 5.08876C11.4301 5.35883 10.1128 5.57366 8.60788 6.89941C7.33093 8.02432 6.81224 8.98982 6.36174 10.6272C5.92026 12.2319 5.84024 13.3069 6.36174 14.8876C6.94611 16.6588 7.90104 17.4428 9.3566 18.6154C10.3034 19.3781 10.8747 19.8314 12.0306 20.213C13.6958 20.7628 14.869 20.7959 16.5229 20.213C18.2018 19.6213 19.0293 18.7889 20.0525 17.3373C21.0243 15.9586 21.4596 14.972 21.5499 13.2899C21.6322 11.7582 21.2377 10.8909 20.6943 9.45562C20.2988 8.4113 20.1431 7.74427 19.4108 6.89941C18.5399 5.89481 17.8083 5.43915 16.5229 5.08876C15.3545 4.77028 14.6213 4.92594 13.421 5.08876Z",
  // 임 (ㅣ)
  "M30.5345 2L31.0693 20.213",
  // 임 (ㅁ)
  "M17.4855 27.0296L31.0693 25.9645L31.7111 37.574L18.3412 38L17.4855 27.0296Z",
  // 희 (ㅎ) - 점
  "M54.8143 4.13018L55.349 10.6272",
  // 희 (ㅎ) - 가로획
  "M55.349 10.6272L47.9689 11.3728M55.349 10.6272L63.5849 9.98817",
  // 희 (ㅎ) - ㅇ
  "M51.6055 19.4675C50.9449 20.5568 50.9029 21.3916 50.9637 22.6627C51.0129 23.6905 51.0444 24.3548 51.6055 25.2189C52.31 26.304 53.1513 26.6336 54.3864 27.0296C55.8178 27.4885 56.7851 27.4195 58.2369 27.0296C59.6275 26.6561 60.6289 26.4003 61.4457 25.2189C62.1936 24.1372 62.227 23.2232 62.0875 21.9172C61.9645 20.765 61.7448 20.0527 61.0179 19.1479C60.0953 17.9996 59.1387 17.6782 57.7021 17.3373C56.4425 17.0383 55.6163 16.9338 54.3864 17.3373C53.085 17.7642 52.3136 18.2994 51.6055 19.4675Z",
  // 희 (ㅢ) - 세로획
  "M68.505 6.26035L69.5746 31.8225",
  // 희 (ㅢ) - 가로획
  "M69.5746 31.8225L50.0011 35.0178",
  // 희 (ㅢ) - 점
  "M69.5746 37.574V31.8225",
  // 재 (ㅈ) - 상단
  "M84.9767 10.6272L95.1378 9.98817L91.1803 19.5207",
  // 재 (ㅈ) - 하단
  "M87.2228 29.0533L91.1803 19.5207M91.1803 19.5207L97.9188 29.0533",
  // 재 (ㅐ) - 세로획1
  "M102.946 9.45562L103.855 21.1716M104.764 32.8876L103.855 21.1716",
  // 재 (ㅐ) - 가로획
  "M103.855 21.1716L112.037 20.213",
  // 재 (ㅐ) - 세로획2
  "M112.037 20.213L111.182 8.07101M112.037 20.213L113 32.8876",
];

const SVG_CONFIG = {
  groom: {
    strokes: GROOM_STROKES,
    width: 120,
    height: 48,
    viewBox: "0 0 120 48",
  },
  bride: {
    strokes: BRIDE_STROKES,
    width: 119,
    height: 48,
    viewBox: "0 0 119 48",
  },
} as const;

// 각 획의 애니메이션 지속 시간 (초)
const STROKE_DURATION = 0.3;
// 획 간 딜레이 (초)
const STROKE_DELAY = 0.15;

export const WriteOurName = ({ name, className = "" }: WriteOurNameProps) => {
  const ref = useRef<SVGSVGElement>(null);
  const isInView = useInView(ref, { once: true, margin: "-20% 0px -20% 0px" });

  const config = SVG_CONFIG[name];

  return (
    <svg
      ref={ref}
      width={config.width}
      height={config.height}
      viewBox={config.viewBox}
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      className={className}
    >
      {config.strokes.map((stroke, index) => (
        <motion.path
          key={index}
          d={stroke}
          stroke="currentColor"
          strokeWidth={4}
          strokeLinecap="round"
          strokeLinejoin="round"
          fill="none"
          initial={{ pathLength: 0, opacity: 0 }}
          animate={
            isInView
              ? { pathLength: 1, opacity: 1 }
              : { pathLength: 0, opacity: 0 }
          }
          transition={{
            pathLength: {
              duration: STROKE_DURATION,
              ease: "easeOut",
              delay: index * STROKE_DELAY,
            },
            opacity: {
              duration: 0.1,
              delay: index * STROKE_DELAY,
            },
          }}
        />
      ))}
    </svg>
  );
};
